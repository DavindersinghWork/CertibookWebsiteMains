<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Profile</title>

<style>
    * {
        box-sizing: border-box;
    }

    body {
        margin: 0;
        min-height: 100vh;
        font-family: system-ui, Arial, sans-serif;
        background: linear-gradient(135deg, #e8f5ff, #d6f7ef, #ffffff);
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px 10px;
    }

    /* Main card */
    .profile-card {
        width: 100%;
        max-width: 880px;
        background: #ffffffba;
        backdrop-filter: blur(12px);
        border-radius: 22px;
        padding: 28px 34px;
        box-shadow: 0 12px 35px rgba(0,0,0,0.08);
        display: grid;
        grid-template-columns: 260px 1fr;
        gap: 24px;
        border: 1px solid #d7e6ed;
    }

    /* Left section */
    .left {
        display: flex;
        flex-direction: column;
        align-items: center;
        border-right: 1px solid #e3e8ee;
        padding-right: 20px;
    }

    .avatar-wrapper {
        width: 150px;
        height: 150px;
        border-radius: 100%;
        overflow: hidden;
        border: 4px solid #d4eef3;
        background: #f0fbff;
    }

    .avatar {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .student-name {
        margin-top: 14px;
        font-size: 1.6rem;
        font-weight: 600;
        color: #073a4b;
        text-align: center;
    }

    .small-email {
        color: #446b7c;
        font-size: 0.9rem;
        margin-top: 4px;
        text-align: center;
    }

    .institution-pill {
        margin-top: 8px;
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.8rem;
        color: #0c6c54;
        border: 1px solid #9adecf;
        background: #e9fffa;
    }

    /* Right Section */
    .right {
        padding-left: 10px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 18px;
    }

    .header-row {
        grid-column: 1 / -1;
        display: flex;
        justify-content: space-between;
        margin-bottom: 4px;
    }

    .header-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: #053949;
    }

    .verified-pill {
        padding: 6px 14px;
        font-size: 0.75rem;
        border-radius: 20px;
        background: #e8fff1;
        border: 1px solid #94e0b3;
        color: #0a7a44;
    }

    .field {
        display: flex;
        flex-direction: column;
    }

    .field-label {
        font-size: 0.78rem;
        letter-spacing: 0.08em;
        color: #6b8795;
        text-transform: uppercase;
        margin-bottom: 4px;
    }

    .field-value {
        padding: 10px 12px;
        border-radius: 10px;
        background: #f7fafc;
        border: 1px solid #d9e3ea;
        color: #063b4e;
    }

    .field-value input {
        width: 100%;
        border: none;
        outline: none;
        background: transparent;
        font-size: 1rem;
        color: inherit;
    }

    /* Mobile */
    @media (max-width: 760px) {
        .profile-card {
            grid-template-columns: 1fr;
        }
        .left {
            border-right: none;
            border-bottom: 1px solid #e3e8ee;
            padding-bottom: 20px;
        }
        .right {
            grid-template-columns: 1fr;
        }
    }
</style>
</head>

<body>

<div class="profile-card">
    <!-- LEFT -->
    <div class="left">
        <div class="avatar-wrapper">
            <img id="avatar" class="avatar" src="https://via.placeholder.com/150" />
        </div>

        <div id="fullName" class="student-name">Student Name</div>
        <div id="emailSmall" class="small-email">email@example.com</div>
        <div id="institutionPill" class="institution-pill">Institution Name</div>
    </div>

    <!-- RIGHT -->
    <div class="right">
        <div class="header-row">
            <div class="header-title">Profile Details</div>
            <div class="verified-pill">Verified Student</div>
        </div>

        <div class="field">
            <div class="field-label">First Name</div>
            <div class="field-value"><input id="firstName" readonly></div>
        </div>

        <div class="field">
            <div class="field-label">Last Name</div>
            <div class="field-value"><input id="lastName" readonly></div>
        </div>

        <div class="field">
            <div class="field-label">Date of Birth</div>
            <div class="field-value"><input id="dob" readonly></div>
        </div>

        <div class="field">
            <div class="field-label">Email</div>
            <div class="field-value"><input id="email" readonly></div>
        </div>

        <div class="field">
            <div class="field-label">Contact Number</div>
            <div class="field-value"><input id="contact" readonly></div>
        </div>

        <div class="field">
            <div class="field-label">Institution</div>
            <div class="field-value"><input id="institution" readonly></div>
        </div>
    </div>
</div>

<script>
const API_BASE = "http://localhost:3000";

async function loadProfile() {
    try {
        const res = await fetch(`${API_BASE}/api/profile`);
        const data = await res.json();

        if (!res.ok || !data.success) {
            console.error("Profile fetch error:", data);
            return;
        }

        const p = data.profile;

        // Right Section Input Fields
        document.getElementById("firstName").value = p.firstName || "";
        document.getElementById("lastName").value = p.lastName || "";
        document.getElementById("dob").value = p.dob ? p.dob.substring(0, 10) : "";
        document.getElementById("email").value = p.email || "";
        document.getElementById("contact").value = p.contact || "";
        document.getElementById("institution").value = p.institution || "";

        // Left Summary
        const fullName = [p.firstName, p.lastName].filter(Boolean).join(" ");
        document.getElementById("fullName").textContent = fullName;

        document.getElementById("emailSmall").textContent = p.email || "";
        document.getElementById("institutionPill").textContent = p.institution || "Institution";

        // Avatar
        const avatar = document.getElementById("avatar");
        avatar.src = p.photoUrl 
            ? p.photoUrl 
            : `https://i.pravatar.cc/200?u=${encodeURIComponent(p.email)}`;
    } 
    catch (err) {
        console.error(err);
    }
}

loadProfile();
</script>

</body>
</html>
